<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shannon Lee">
<meta name="dcterms.date" content="2024-02-28">

<title>ISSS608-VAA - Take-home Exercise 4</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<script src="../../site_libs/jquery-1.11.1/jquery.min.js"></script>
<link href="../../site_libs/dygraphs-1.1.1/dygraph.css" rel="stylesheet">
<script src="../../site_libs/dygraphs-1.1.1/dygraph-combined.js"></script>
<script src="../../site_libs/dygraphs-1.1.1/shapes.js"></script>
<script src="../../site_libs/moment-2.8.4/moment.js"></script>
<script src="../../site_libs/moment-timezone-0.2.5/moment-timezone-with-data.js"></script>
<script src="../../site_libs/moment-fquarter-1.0.0/moment-fquarter.min.js"></script>
<script src="../../site_libs/dygraphs-binding-1.1.1.6/dygraphs.js"></script>


<link rel="stylesheet" href="../../styles.css">
<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">ISSS608-VAA</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex04/Hands-on_Ex04.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05C.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05D.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5d</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex05/Hands-on_Ex05E.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 5e</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07A.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7a</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07B.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7b</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex07/Hands-on_Ex07C.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 7c</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex08/Hands-on_Ex08.html" rel="" target="">
 <span class="dropdown-text">Hands-on Exercise 8</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex01/In-class_Ex01.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html" rel="" target="">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false" rel="" target="">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex03/Take-home_Ex03.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex04/Take-home_Ex04.html" rel="" target="">
 <span class="dropdown-text">Take-home Exercise 4</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html" rel="" target="">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#project-objectives" id="toc-project-objectives" class="nav-link active" data-scroll-target="#project-objectives">Project Objectives</a></li>
  <li><a href="#data-preparation" id="toc-data-preparation" class="nav-link" data-scroll-target="#data-preparation">1. Data Preparation</a>
  <ul class="collapse">
  <li><a href="#installing-r-packages" id="toc-installing-r-packages" class="nav-link" data-scroll-target="#installing-r-packages">1.1 Installing R packages</a></li>
  <li><a href="#importing-dataset" id="toc-importing-dataset" class="nav-link" data-scroll-target="#importing-dataset">1.2 Importing Dataset</a></li>
  <li><a href="#data-wrangling" id="toc-data-wrangling" class="nav-link" data-scroll-target="#data-wrangling">1.3 Data Wrangling</a>
  <ul class="collapse">
  <li><a href="#for-monthly-changes-material_price_month" id="toc-for-monthly-changes-material_price_month" class="nav-link" data-scroll-target="#for-monthly-changes-material_price_month"><strong>For Monthly Changes (<code>material_price_month</code>):</strong></a></li>
  <li><a href="#for-quarterly-averages-and-changes-material_price_quarter_avg" id="toc-for-quarterly-averages-and-changes-material_price_quarter_avg" class="nav-link" data-scroll-target="#for-quarterly-averages-and-changes-material_price_quarter_avg"><strong>For Quarterly Averages and Changes (<code>material_price_quarter_avg</code>):</strong></a></li>
  <li><a href="#monthly-average-and-percentage-change-computations-sti_month_avg" id="toc-monthly-average-and-percentage-change-computations-sti_month_avg" class="nav-link" data-scroll-target="#monthly-average-and-percentage-change-computations-sti_month_avg"><strong>Monthly Average and Percentage Change Computations (<code>sti_month_avg</code>):</strong></a></li>
  <li><a href="#quarterly-average-and-percentage-change-computations-sti_quarter_avg" id="toc-quarterly-average-and-percentage-change-computations-sti_quarter_avg" class="nav-link" data-scroll-target="#quarterly-average-and-percentage-change-computations-sti_quarter_avg"><strong>Quarterly Average and Percentage Change Computations (<code>sti_quarter_avg</code>):</strong></a></li>
  <li><a href="#monthly-rate-change-computations-tbillbond_month_avg" id="toc-monthly-rate-change-computations-tbillbond_month_avg" class="nav-link" data-scroll-target="#monthly-rate-change-computations-tbillbond_month_avg"><strong>Monthly Rate Change Computations (<code>tbillbond_month_avg</code>):</strong></a></li>
  <li><a href="#quarterly-rate-change-computations-tbillbond_quarter_avg" id="toc-quarterly-rate-change-computations-tbillbond_quarter_avg" class="nav-link" data-scroll-target="#quarterly-rate-change-computations-tbillbond_quarter_avg"><strong>Quarterly Rate Change Computations (<code>tbillbond_quarter_avg</code>):</strong></a></li>
  <li><a href="#for-the-monthly-data-sora_month_avg" id="toc-for-the-monthly-data-sora_month_avg" class="nav-link" data-scroll-target="#for-the-monthly-data-sora_month_avg"><strong>For the Monthly Data (<code>sora_month_avg</code>):</strong></a></li>
  <li><a href="#for-the-quarterly-data-sora_quarter_avg" id="toc-for-the-quarterly-data-sora_quarter_avg" class="nav-link" data-scroll-target="#for-the-quarterly-data-sora_quarter_avg"><strong>For the Quarterly Data (<code>sora_quarter_avg</code>):</strong></a></li>
  <li><a href="#for-monthly-data-aggregation-data_by_month" id="toc-for-monthly-data-aggregation-data_by_month" class="nav-link" data-scroll-target="#for-monthly-data-aggregation-data_by_month"><strong>For Monthly Data Aggregation (<code>data_by_month</code>):</strong></a></li>
  <li><a href="#for-quarterly-data-aggregation-data_by_quarter" id="toc-for-quarterly-data-aggregation-data_by_quarter" class="nav-link" data-scroll-target="#for-quarterly-data-aggregation-data_by_quarter"><strong>For Quarterly Data Aggregation (<code>data_by_quarter</code>):</strong></a></li>
  </ul></li>
  </ul></li>
  <li><a href="#data-visualisation-techniques" id="toc-data-visualisation-techniques" class="nav-link" data-scroll-target="#data-visualisation-techniques">2. Data Visualisation Techniques</a>
  <ul class="collapse">
  <li><a href="#arima-autoregressive-integrated-moving-average" id="toc-arima-autoregressive-integrated-moving-average" class="nav-link" data-scroll-target="#arima-autoregressive-integrated-moving-average"><strong><code>ARIMA (Autoregressive Integrated Moving Average)</code></strong></a></li>
  <li><a href="#arfima-autoregressive-fractionally-integrated-moving-average" id="toc-arfima-autoregressive-fractionally-integrated-moving-average" class="nav-link" data-scroll-target="#arfima-autoregressive-fractionally-integrated-moving-average"><strong><code>ARFIMA (Autoregressive Fractionally Integrated Moving Average)</code></strong></a></li>
  <li><a href="#ets-error-trend-seasonality" id="toc-ets-error-trend-seasonality" class="nav-link" data-scroll-target="#ets-error-trend-seasonality"><strong><code>ETS (Error, Trend, Seasonality)</code></strong></a></li>
  <li><a href="#holt-winters-method" id="toc-holt-winters-method" class="nav-link" data-scroll-target="#holt-winters-method"><strong><code>Holt-Winters Method</code></strong></a></li>
  <li><a href="#tbats" id="toc-tbats" class="nav-link" data-scroll-target="#tbats"><strong><code>TBATS</code></strong></a></li>
  </ul></li>
  <li><a href="#data-visualization-design" id="toc-data-visualization-design" class="nav-link" data-scroll-target="#data-visualization-design">3. Data Visualization Design</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 4</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shannon Lee </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 28, 2024</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 10, 2024</p>
    </div>
  </div>
    
  </div>
  

</header>

<section id="project-objectives" class="level1">
<h1>Project Objectives</h1>
<p>In this take-home exercise, we are required to select one of the modules of our proposed Shiny application and complete the following tasks:</p>
<ul>
<li><p>To evaluate and determine the necessary R packages needed for our Shiny application are supported in R CRAN,</p></li>
<li><p>To prepare and test the specific R codes to ensure they can be run and return the correct output as expected,</p></li>
<li><p>To determine the parameters and outputs that will be exposed on the Shiny applications, and</p></li>
<li><p>To select the appropriate Shiny UI components for exposing the parameters determined above.</p></li>
</ul>
</section>
<section id="data-preparation" class="level1">
<h1>1. Data Preparation</h1>
<section id="installing-r-packages" class="level2">
<h2 class="anchored" data-anchor-id="installing-r-packages">1.1 Installing R packages</h2>
<p><strong><code>pacman::p_load()</code></strong> function from the pacman package is utilized to install (if necessary) and load the libraries for the specified packages:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Set CRAN repository</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">repos =</span> <span class="fu">c</span>(<span class="at">CRAN =</span> <span class="st">"http://cran.rstudio.com"</span>))</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Install necessary packages if not already installed</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">"pacman"</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>)) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(xts, tidyverse, forecast, timetk, tseries, dplyr, readxl, lubridate, gridExtra, ggplot2, dygraphs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="importing-dataset" class="level2">
<h2 class="anchored" data-anchor-id="importing-dataset">1.2 Importing Dataset</h2>
<p>We proceed to import and format multiple data-sets.</p>
<ul>
<li><p><strong>Private Housing Price Index (PPI)</strong>:</p>
<ul>
<li><p>We read the data from a CSV file and set column names for dates and different types of private housing prices.</p></li>
<li><p>We convert the ‘Date’ column to a date format and then mutate it to extract the ‘Month’ and ‘Year’.</p></li>
<li><p>Finally, we convert ‘Year’ into a factor (categorical variable).</p></li>
</ul></li>
<li><p><strong>Construction Material Prices</strong>:</p>
<ul>
<li><p>Similar to the PPI dataset, we read this data from a CSV file with specific material prices listed.</p></li>
<li><p>We format the dates, and extract and convert ‘Year’ and ‘Month’ into factors.</p></li>
</ul></li>
<li><p><strong>Strait Times Index (STI)</strong>:</p>
<ul>
<li><p>We read this dataset, which includes columns for the date and the index value.</p></li>
<li><p>We split the ‘Date’ into ‘Year’, ‘Month’, and ‘Day’, and convert both ‘Year’ and ‘Month’ into factors.</p></li>
</ul></li>
<li><p><strong>Treasury Bill and Bond Rates (tbillbond)</strong>:</p>
<ul>
<li><p>We read and process the Treasury rates data similarly to the other datasets.</p></li>
<li><p>We extract ‘Year’, ‘Month’, and ‘Day’ from the ‘Date’ and convert them into factors, removing unnecessary columns (specific bond years not needed).</p></li>
</ul></li>
<li><p><strong>Singapore Overnight Rate Average (SORA)</strong>:</p>
<ul>
<li><p>This dataset is processed to contain rates for specific dates.</p></li>
<li><p>As with the others, we parse the ‘Date’ and break it down into ‘Year’, ‘Month’, and ‘Day’, which are then converted into factors.</p></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ppi <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'../../data/PPI_private_housing.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'PR_All'</span>, <span class="st">'PR_Landed'</span>, <span class="st">'PR_NL_ALL'</span>, <span class="st">'PR_NL_CCR'</span>, <span class="st">'PR_NL_RCR'</span>, <span class="st">'PR_NL_OCR'</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Year =</span> Date) <span class="sc">%&gt;%</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>material_price <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'../../data/Construction Materials prices.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Cement'</span>, <span class="st">'SteelBar'</span>, <span class="st">'Granite'</span>, <span class="st">'ConcretingSand'</span>, <span class="st">'ReadyMixConcrete'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>sti <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'../../data/Index FTSE Strait Times.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Index'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>tbillbond <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'../../data/Treasury_Bill_Bond_ rates.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Bill1Yr'</span>, <span class="st">'Bond2Yr'</span>, <span class="st">'Bond5Yr'</span>, <span class="st">'Bond10Yr'</span>, <span class="st">'Bond15Yr'</span>, <span class="st">'Bond20Yr'</span>,<span class="st">'Bond30Yr'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Bond15Yr, <span class="sc">-</span>Bond20Yr, <span class="sc">-</span>Bond30Yr)</span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>sora <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">'../../data/Singapore Overnight Rate Average SORA Daily.csv'</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">setNames</span>(<span class="fu">c</span>(<span class="st">'Date'</span>, <span class="st">'Rate'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date, <span class="at">format =</span> <span class="st">'%d/%m/%Y'</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">year</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">month</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Day =</span> <span class="fu">day</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Year =</span> <span class="fu">as.factor</span>(Year)) <span class="sc">%&gt;%</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Month =</span> <span class="fu">as.factor</span>(Month))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="data-wrangling" class="level2">
<h2 class="anchored" data-anchor-id="data-wrangling">1.3 Data Wrangling</h2>
<p>We perform several operations on the ‘ppi’ dataset to compute the percentage changes for various property price indices (PPI) and organize the data into quarters:</p>
<ul>
<li><p><strong>Percentage Change Computations</strong>:</p>
<ul>
<li>We calculate the percentage change for different categories of property prices (PR_All, PR_Landed, PR_NL_ALL, PR_NL_CCR, PR_NL_RCR, PR_NL_OCR) compared to the previous time period. This is done by subtracting the previous value from the current value (<strong><code>PR_All - lag(PR_All)</code></strong>), dividing by the previous value (<strong><code>/lag(PR_All)</code></strong>), and then multiplying by 100 to convert it to a percentage. The <strong><code>lag()</code></strong> function is used to obtain the previous value in each series.</li>
</ul></li>
<li><p><strong>Quarter Assignment</strong>:</p>
<ul>
<li>We assign each record to a quarter based on the month. This is done using the <strong><code>case_when</code></strong> function. If the month is 3 (March), it is assigned to ‘Q1’; if 6 (June), to ‘Q2’; if 9 (September), to ‘Q3’; and if 12 (December), to ‘Q4’. This categorization helps in analyzing the data on a quarterly basis.</li>
</ul></li>
<li><p><strong>Data Selection and Reordering</strong>:</p>
<ul>
<li><p>We remove the ‘Month’ column from the dataset as it’s no longer needed after we have assigned the data to quarters.</p></li>
<li><p>We reorder the columns so that ‘Year’ and ‘Quarter’ appear first, followed by the rest of the columns. This reordering makes the dataset more organized and easier to understand, especially when analyzing the data based on time periods.</p></li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PPI - percentage change computations</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>ppi_quarter <span class="ot">&lt;-</span> ppi <span class="sc">%&gt;%</span> </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_All</span><span class="st">`</span> <span class="ot">=</span> (PR_All <span class="sc">-</span> <span class="fu">lag</span>(PR_All))<span class="sc">/</span><span class="fu">lag</span>(PR_All)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_Landed</span><span class="st">`</span> <span class="ot">=</span> (PR_Landed <span class="sc">-</span> <span class="fu">lag</span>(PR_Landed))<span class="sc">/</span><span class="fu">lag</span>(PR_Landed)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_ALL</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_ALL <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_ALL))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_ALL)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_CCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_CCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_CCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_CCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_RCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_RCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_RCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_RCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_PR_NL_OCR</span><span class="st">`</span> <span class="ot">=</span> (PR_NL_OCR <span class="sc">-</span> <span class="fu">lag</span>(PR_NL_OCR))<span class="sc">/</span><span class="fu">lag</span>(PR_NL_OCR)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    Month <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Month) <span class="sc">%&gt;%</span> </span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="st">'Year'</span>,<span class="st">'Quarter'</span>,<span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We perform percentage change computations for various construction material prices on both a monthly and quarterly basis:</p>
<section id="for-monthly-changes-material_price_month" class="level3">
<h3 class="anchored" data-anchor-id="for-monthly-changes-material_price_month"><strong>For Monthly Changes (<code>material_price_month</code>):</strong></h3>
<ul>
<li><p><strong>Percentage Changes Calculation</strong>: We calculate the percentage change for each material (Cement, SteelBar, Granite, ConcretingSand, ReadyMixConcrete) from one month to the next. This is achieved by subtracting the previous month’s value from the current month’s (using <strong><code>lag()</code></strong>), dividing by the previous month’s value, and multiplying by 100 to get the change as a percentage.</p></li>
<li><p><strong>Data Selection and Reordering</strong>: We remove the ‘Date’ column as it’s no longer necessary. We ensure ‘Year’ and ‘Month’ are at the beginning of our dataset, followed by the calculated percentage changes for each material, making the dataset focused and easier to analyze on a monthly basis.</p></li>
</ul>
</section>
<section id="for-quarterly-averages-and-changes-material_price_quarter_avg" class="level3">
<h3 class="anchored" data-anchor-id="for-quarterly-averages-and-changes-material_price_quarter_avg"><strong>For Quarterly Averages and Changes (<code>material_price_quarter_avg</code>):</strong></h3>
<ul>
<li><p><strong>Quarter Assignment</strong>: We categorize each month into a corresponding quarter: January to March as Q1, April to June as Q2, July to September as Q3, and October to December as Q4.</p></li>
<li><p><strong>Averaging</strong>: We then group the data by ‘Year’ and ‘Quarter’ and calculate the average price for each material in each quarter. This provides us with mean values that represent the average material price for each quarter.</p></li>
<li><p><strong>Percentage Changes Calculation</strong>: Similar to the monthly data, we calculate the percentage change in average prices for each material from one quarter to the next. This involves using the average price of the current quarter, subtracting the average price of the previous quarter, and then dividing by the previous quarter’s average price, multiplied by 100 to express the result as a percentage.</p></li>
<li><p><strong>Data Selection and Reordering</strong>: We exclude ‘Date’ and ‘Month’ from the dataset as they’re redundant after quarter assignment. We arrange the columns to start with ‘Year’ and ‘Quarter’, followed by the percentage changes for each material, ensuring clarity and structured data for quarterly analysis.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_month - percentage change computations</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>material_price_month <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date) <span class="sc">%&gt;%</span> </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># material price_quarter_avg - percentage change computations</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>material_price_quarter_avg <span class="ot">&lt;-</span> material_price <span class="sc">%&gt;%</span></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month) <span class="sc">%&gt;%</span></span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span> </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Cement</span><span class="st">`</span> <span class="ot">=</span> (Cement <span class="sc">-</span> <span class="fu">lag</span>(Cement))<span class="sc">/</span><span class="fu">lag</span>(Cement)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_SteelBar</span><span class="st">`</span> <span class="ot">=</span> (SteelBar <span class="sc">-</span> <span class="fu">lag</span>(SteelBar))<span class="sc">/</span><span class="fu">lag</span>(SteelBar)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Granite</span><span class="st">`</span> <span class="ot">=</span> (Granite <span class="sc">-</span> <span class="fu">lag</span>(Granite))<span class="sc">/</span><span class="fu">lag</span>(Granite)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ConcretingSand</span><span class="st">`</span> <span class="ot">=</span> (ConcretingSand <span class="sc">-</span> <span class="fu">lag</span>(ConcretingSand))<span class="sc">/</span><span class="fu">lag</span>(ConcretingSand)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_ReadyMixConcrete</span><span class="st">`</span> <span class="ot">=</span> (ReadyMixConcrete <span class="sc">-</span> <span class="fu">lag</span>(ReadyMixConcrete))<span class="sc">/</span><span class="fu">lag</span>(ReadyMixConcrete)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Next, we process the ‘sti’ dataset to compute average values and percentage changes for the Strait Times Index (STI) on both a monthly and quarterly basis:</p>
</section>
<section id="monthly-average-and-percentage-change-computations-sti_month_avg" class="level3">
<h3 class="anchored" data-anchor-id="monthly-average-and-percentage-change-computations-sti_month_avg"><strong>Monthly Average and Percentage Change Computations (<code>sti_month_avg</code>):</strong></h3>
<ul>
<li><p><strong>Grouping and Averaging</strong>:</p>
<ul>
<li><p>We group the data by ‘Year’ and ‘Month’.</p></li>
<li><p>We then calculate the average (‘mean’) for all the columns for each group. This primarily affects the ‘Index’ values, providing us with the average index value for each month.</p></li>
</ul></li>
<li><p><strong>Percentage Change</strong>:</p>
<ul>
<li><p>We ungroup the data to apply operations across all rows.</p></li>
<li><p>We compute the percentage change in the ‘Index’ by comparing each month’s average index value to the previous month’s (using <strong><code>Index - lag(Index)</code></strong> divided by <strong><code>lag(Index)</code></strong> and then multiplied by 100).</p></li>
</ul></li>
<li><p><strong>Data Selection and Reordering</strong>:</p>
<ul>
<li><p>We remove the ‘Date’ and ‘Day’ columns as they are not needed after computing the monthly averages.</p></li>
<li><p>We reorder the columns so that ‘Year’ and ‘Month’ appear first, enhancing readability and making the dataset more focused on the time-series analysis.</p></li>
</ul></li>
</ul>
</section>
<section id="quarterly-average-and-percentage-change-computations-sti_quarter_avg" class="level3">
<h3 class="anchored" data-anchor-id="quarterly-average-and-percentage-change-computations-sti_quarter_avg"><strong>Quarterly Average and Percentage Change Computations (<code>sti_quarter_avg</code>):</strong></h3>
<ul>
<li><p><strong>Quarter Assignment</strong>:</p>
<ul>
<li>We assign each record to a quarter based on the month using the <strong><code>case_when</code></strong> function. Months are grouped into Q1 (January to March), Q2 (April to June), Q3 (July to September), and Q4 (October to December).</li>
</ul></li>
<li><p><strong>Data Selection</strong>:</p>
<ul>
<li>We remove ‘Date’, ‘Month’, and ‘Day’ columns as the analysis is now on a quarterly basis.</li>
</ul></li>
<li><p><strong>Grouping and Averaging</strong>:</p>
<ul>
<li><p>We group the data by ‘Year’ and the newly assigned ‘Quarter’.</p></li>
<li><p>We calculate the mean for all columns for each group, which primarily changes the ‘Index’ values to represent the average for each quarter.</p></li>
</ul></li>
<li><p><strong>Percentage Change</strong>:</p>
<ul>
<li>After ungrouping, we compute the percentage change in the ‘Index’ similar to the monthly computation, but this time comparing each quarter’s average index value to the previous quarter’s.</li>
</ul></li>
<li><p><strong>Data Reordering</strong>:</p>
<ul>
<li>Finally, we reorder the columns to have ‘Year’ and ‘Quarter’ at the beginning, followed by the other columns. This reordering makes the dataset more intuitive for quarterly time-series analysis.</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_month_avg - percentage change computations</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>sti_month_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sti_quarter_avg - percentage change computations</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>sti_quarter_avg <span class="ot">&lt;-</span> sti <span class="sc">%&gt;%</span> </span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span>         </span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">%Change_Index</span><span class="st">`</span> <span class="ot">=</span> (Index <span class="sc">-</span> <span class="fu">lag</span>(Index))<span class="sc">/</span><span class="fu">lag</span>(Index)<span class="sc">*</span><span class="dv">100</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We carried out rate change computations for Treasury Bill and Bond rates on both a monthly and quarterly basis:</p>
</section>
<section id="monthly-rate-change-computations-tbillbond_month_avg" class="level3">
<h3 class="anchored" data-anchor-id="monthly-rate-change-computations-tbillbond_month_avg"><strong>Monthly Rate Change Computations (<code>tbillbond_month_avg</code>):</strong></h3>
<ul>
<li><p><strong>Grouping and Averaging</strong>:</p>
<ul>
<li><p>We group the data by ‘Year’ and ‘Month’.</p></li>
<li><p>We calculate the mean (average) for all the columns for each group, primarily affecting the rates (Bill1Yr, Bond2Yr, Bond5Yr, Bond10Yr), which results in average rates for each month.</p></li>
</ul></li>
<li><p><strong>Rate Changes</strong>:</p>
<ul>
<li>After ungrouping the dataset, we compute the absolute changes (not percentage) in rates from one month to the next for different securities (1-year Treasury Bill, 2-year Bond, 5-year Bond, and 10-year Bond). This is done by subtracting the previous month’s rate from the current month’s rate for each type of rate (using the <strong><code>lag()</code></strong> function).</li>
</ul></li>
<li><p><strong>Data Selection and Reordering</strong>:</p>
<ul>
<li><p>We remove the ‘Date’ and ‘Day’ columns as they are unnecessary after monthly aggregation.</p></li>
<li><p>We reorder the columns so that ‘Year’ and ‘Month’ are at the beginning, followed by the rate change calculations and other relevant data, making the dataset structured and easier to analyze monthly changes.</p></li>
</ul></li>
</ul>
</section>
<section id="quarterly-rate-change-computations-tbillbond_quarter_avg" class="level3">
<h3 class="anchored" data-anchor-id="quarterly-rate-change-computations-tbillbond_quarter_avg"><strong>Quarterly Rate Change Computations (<code>tbillbond_quarter_avg</code>):</strong></h3>
<ul>
<li><p><strong>Quarter Assignment</strong>:</p>
<ul>
<li>Similar to the monthly computation, we first assign each record to a quarter based on the month using the <strong><code>case_when</code></strong> function.</li>
</ul></li>
<li><p><strong>Data Selection and Grouping</strong>:</p>
<ul>
<li>We remove unnecessary ‘Date’, ‘Month’, and ‘Day’ columns and then group the data by ‘Year’ and ‘Quarter’.</li>
</ul></li>
<li><p><strong>Averaging</strong>:</p>
<ul>
<li>We calculate the mean for all the columns for each ‘Year’ and ‘Quarter’ group, focusing on the rates to obtain quarterly averages.</li>
</ul></li>
<li><p><strong>Rate Changes</strong>:</p>
<ul>
<li><p>We ungroup the data for broad application of subsequent functions.</p></li>
<li><p>We compute the absolute changes in rates from one quarter to the next for the different securities. This involves calculating the difference between each quarter’s average rate and the previous quarter’s average rate for each type of security.</p></li>
</ul></li>
<li><p><strong>Data Reordering</strong>:</p>
<ul>
<li>Finally, we reorder the columns to start with ‘Year’ and ‘Quarter’, followed by the calculated rate changes and other data, ensuring the dataset is well-organized for analyzing quarterly trends.</li>
</ul></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_month - rate change computations</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>tbillbond_month_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># tbillbond_quarter_avg - percentage change computations</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>tbillbond_quarter_avg <span class="ot">&lt;-</span> tbillbond <span class="sc">%&gt;%</span> </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span> </span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bill1Yr</span><span class="st">`</span> <span class="ot">=</span> Bill1Yr <span class="sc">-</span> <span class="fu">lag</span>(Bill1Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond2Yr</span><span class="st">`</span> <span class="ot">=</span> Bond2Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond2Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond5Yr</span><span class="st">`</span> <span class="ot">=</span> Bond5Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond5Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Bond10Yr</span><span class="st">`</span> <span class="ot">=</span> Bond10Yr <span class="sc">-</span> <span class="fu">lag</span>(Bond10Yr)) <span class="sc">%&gt;%</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We perform percentage change computations for the Singapore Overnight Rate Average (SORA) on both monthly and quarterly bases to analyze the fluctuations in interest rates over time:</p>
</section>
<section id="for-the-monthly-data-sora_month_avg" class="level3">
<h3 class="anchored" data-anchor-id="for-the-monthly-data-sora_month_avg"><strong>For the Monthly Data (<code>sora_month_avg</code>):</strong></h3>
<ul>
<li><p><strong>Grouping and Averaging</strong>: We group the data by ‘Year’ and ‘Month’ and then calculate the average for all columns within each group. This specifically impacts the ‘Rate’, providing us with the average SORA for each month.</p></li>
<li><p><strong>Rate Changes</strong>: After removing the group structure by ungrouping, we calculate the month-to-month change in SORA. We achieve this by subtracting the previous month’s rate from the current month’s rate, obtaining the absolute change in rate.</p></li>
<li><p><strong>Data Selection and Reordering</strong>: We remove ‘Date’ and ‘Day’ columns, as they’re not required post-aggregation. We then reorder the columns to have ‘Year’ and ‘Month’ at the beginning, followed by the rate changes and other pertinent data, making the dataset well-organized for monthly analysis.</p></li>
</ul>
</section>
<section id="for-the-quarterly-data-sora_quarter_avg" class="level3">
<h3 class="anchored" data-anchor-id="for-the-quarterly-data-sora_quarter_avg"><strong>For the Quarterly Data (<code>sora_quarter_avg</code>):</strong></h3>
<ul>
<li><p><strong>Quarter Assignment</strong>: We assign each record to a specific quarter based on its month, categorizing them into Q1 (January-March), Q2 (April-June), Q3 (July-September), and Q4 (October-December) using the <strong><code>case_when</code></strong> function.</p></li>
<li><p><strong>Data Selection and Grouping</strong>: We discard ‘Date’, ‘Month’, and ‘Day’ columns as our focus shifts to quarterly analysis. We then group the data by ‘Year’ and ‘Quarter’ for subsequent processing.</p></li>
<li><p><strong>Averaging</strong>: We compute the mean of all columns for each group defined by ‘Year’ and ‘Quarter’, centering our attention on the ‘Rate’ to ascertain the average SORA for each quarter.</p></li>
<li><p><strong>Rate Changes</strong>: After ungrouping, we calculate the quarter-to-quarter change in SORA by subtracting the rate of the preceding quarter from the rate of the current quarter, thus deriving the absolute rate change.</p></li>
<li><p><strong>Data Reordering</strong>: Lastly, we arrange the columns starting with ‘Year’ and ‘Quarter’, followed by the computed rate changes and other relevant information. This rearrangement ensures that our dataset is systematically organized for evaluating quarterly trends in SORA.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_month - percentage change computations</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>sora_month_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Month) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> </span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span> </span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Month, <span class="fu">everything</span>())</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a><span class="co"># sora_quarter_avg - percentage change computations</span></span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>sora_quarter_avg <span class="ot">&lt;-</span> sora <span class="sc">%&gt;%</span> </span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Quarter =</span> <span class="fu">case_when</span>(</span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">1</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">2</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">3</span>) <span class="sc">~</span> <span class="st">'Q1'</span>,</span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">4</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">5</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">~</span> <span class="st">'Q2'</span>,</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">7</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">8</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">9</span>) <span class="sc">~</span> <span class="st">'Q3'</span>,</span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>    (Month <span class="sc">==</span> <span class="dv">10</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">11</span> <span class="sc">|</span> Month <span class="sc">==</span> <span class="dv">12</span>) <span class="sc">~</span> <span class="st">'Q4'</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a>  )) <span class="sc">%&gt;%</span></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>Date, <span class="sc">-</span>Month, <span class="sc">-</span>Day) <span class="sc">%&gt;%</span></span>
<span id="cb7-19"><a href="#cb7-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Year, Quarter) <span class="sc">%&gt;%</span> </span>
<span id="cb7-20"><a href="#cb7-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise_all</span>(<span class="at">.funs=</span>mean) <span class="sc">%&gt;%</span></span>
<span id="cb7-21"><a href="#cb7-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb7-22"><a href="#cb7-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="st">`</span><span class="at">Change_Rate</span><span class="st">`</span> <span class="ot">=</span> Rate <span class="sc">-</span> <span class="fu">lag</span>(Rate)) <span class="sc">%&gt;%</span> </span>
<span id="cb7-23"><a href="#cb7-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Year, Quarter, <span class="fu">everything</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Finally, we consolidate the various datasets into two comprehensive datasets: one aggregated by month and the other by quarter:</p>
</section>
<section id="for-monthly-data-aggregation-data_by_month" class="level3">
<h3 class="anchored" data-anchor-id="for-monthly-data-aggregation-data_by_month"><strong>For Monthly Data Aggregation (<code>data_by_month</code>):</strong></h3>
<ul>
<li><p><strong>Data Merging</strong>: We start by joining the ‘material_price_month’ dataset with ‘sti_month_avg’, ‘tbillbond_month_avg’, and ‘sora_month_avg’. We ensure that the data align correctly by using ‘Year’ and ‘Month’ as the keys for joining.</p></li>
<li><p><strong>Label Creation</strong>: We then create a ‘MonthLabel’ for each entry by concatenating the ‘Month’ and ‘Year’, making it easier to reference specific points in time.</p></li>
<li><p><strong>Date Standardization</strong>: We convert the ‘Year’ and ‘Month’ into a standard date format, assuming the first day of each month (‘01’) as the default date, to ensure consistency in time-series analysis.</p></li>
<li><p><strong>Data Selection and Reordering</strong>: Finally, we select and rearrange our columns, placing the newly created ‘Date’ and ‘MonthLabel’ at the forefront, while removing redundant ‘Year’ and ‘Month’ columns for clarity and conciseness.</p></li>
</ul>
</section>
<section id="for-quarterly-data-aggregation-data_by_quarter" class="level3">
<h3 class="anchored" data-anchor-id="for-quarterly-data-aggregation-data_by_quarter"><strong>For Quarterly Data Aggregation (<code>data_by_quarter</code>):</strong></h3>
<ul>
<li><p><strong>Data Merging</strong>: Similar to the monthly dataset, we merge ‘ppi_quarter’ with ‘material_price_quarter_avg’, ‘sti_quarter_avg’, ‘tbillbond_quarter_avg’, and ‘sora_quarter_avg’, using ‘Year’ and ‘Quarter’ as joining keys.</p></li>
<li><p><strong>Label Creation</strong>: A ‘QuarterLabel’ is generated for each record by merging the ‘Quarter’ with the ‘Year’, facilitating easy identification of each period.</p></li>
<li><p><strong>Date Standardization</strong>: We standardize the ‘Date’ to represent the first day of the ending month of each quarter (March, June, September, December), transforming ‘Year’ and ‘Quarter’ into a complete date format suitable for time-series evaluations.</p></li>
<li><p><strong>Data Selection and Reordering</strong>: We organize our dataset by selecting necessary columns and rearranging them so that ‘Date’ and ‘QuarterLabel’ lead, streamlining the dataset while omitting redundant ‘Year’ and ‘Quarter’ information.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># put all monthly data into 1 dataset</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> material_price_month <span class="sc">%&gt;%</span> </span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_month_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Month"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">MonthLabel =</span> <span class="fu">paste0</span>(Month, <span class="st">'M'</span>, <span class="fu">as.character</span>(Year))) <span class="sc">%&gt;%</span> </span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(<span class="fu">paste0</span>(<span class="st">'01-'</span>, Month, <span class="st">'-'</span>, Year), <span class="at">format=</span><span class="st">"%d-%m-%Y"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, MonthLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Month)</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a><span class="co"># put all quarter data into 1 dataset</span></span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>data_by_quarter <span class="ot">&lt;-</span> ppi_quarter <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(material_price_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sti_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(tbillbond_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">inner_join</span>(sora_quarter_avg, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"Year"</span>, <span class="st">"Quarter"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">QuarterLabel =</span> <span class="fu">paste0</span>(Quarter, <span class="fu">as.character</span>(Year)))  <span class="sc">%&gt;%</span> </span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">paste0</span>(Year, <span class="st">'-'</span>, <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q1"</span>, <span class="st">"03"</span>, </span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a>                                      <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q2"</span>, <span class="st">"06"</span>,</span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a>                                             <span class="fu">ifelse</span>(Quarter <span class="sc">==</span> <span class="st">"Q3"</span>, <span class="st">"09"</span>, <span class="st">"12"</span>))), <span class="st">"-01"</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date)) <span class="sc">%&gt;%</span> </span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Date, QuarterLabel, <span class="fu">everything</span>(), <span class="sc">-</span>Year, <span class="sc">-</span>Quarter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
</section>
<section id="data-visualisation-techniques" class="level1">
<h1>2. Data Visualisation Techniques</h1>
<p>We decided to choose a diverse set of forecasting models to address the unique characteristics and requirements of our time series data.</p>
<p>By selecting this range of models, we aim to capture the essential dynamics of our dataset, including linear trends, seasonalities, long memory, and non-linear relationships, to ensure robust and accurate forecasting results.</p>
<p>These models include:</p>
<section id="arima-autoregressive-integrated-moving-average" class="level3">
<h3 class="anchored" data-anchor-id="arima-autoregressive-integrated-moving-average"><strong><code>ARIMA (Autoregressive Integrated Moving Average)</code></strong></h3>
<p>Chosen for its versatility in handling various time series patterns, particularly useful for our data showing linear relationships and trends, such as in economic and financial variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Date' is in Date format and 'Cement' column is numeric</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> data_by_month <span class="sc">%&gt;%</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date),</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cement =</span> <span class="fu">as.numeric</span>(Cement))</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the 'Cement' series for demonstration excluding the last 2 months for holdout</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>end_holdout <span class="ot">&lt;-</span> <span class="fu">max</span>(data_by_month<span class="sc">$</span>Date) <span class="sc">-</span> <span class="fu">months</span>(<span class="dv">2</span>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data_by_month, Date <span class="sc">&lt;=</span> end_holdout)</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the filtered series to time series</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>series <span class="ot">&lt;-</span> <span class="fu">ts</span>(training_data<span class="sc">$</span>Cement, <span class="at">start=</span><span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date)), <span class="fu">month</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date))), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARIMA model</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>fit_arima <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(series)</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months including 99% confidence interval</span></span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>future_arima <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_arima, <span class="at">h=</span><span class="dv">12</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert forecast to an 'xts' object for plotting</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>last_training_date <span class="ot">&lt;-</span> <span class="fu">max</span>(training_data<span class="sc">$</span>Date)</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>forecast_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>forecast_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arima<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a><span class="co"># Since the available columns for CI are named "99%", we will use these for the lower and upper bounds.</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arima<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates)</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arima<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an xts object from actual data for plotting</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>actual_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(data_by_month<span class="sc">$</span>Cement, <span class="at">order.by =</span> data_by_month<span class="sc">$</span>Date)</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual, forecasted, and confidence interval data for plotting</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>combined_xts <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts, forecast_lower_xts, forecast_upper_xts, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with dygraph</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts, <span class="at">main =</span> <span class="st">"ARIMA FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-bccfeed5d9bf50e39aaf" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-bccfeed5d9bf50e39aaf">{"x":{"attrs":{"title":"ARIMA FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.7496932321548,112.3541159523371,112.0066164353816,111.7013513950338,111.4331877277142,111.1976161981725,110.9906756156348,110.8088862254467,110.6491911961794,110.5089052182887,110.3856693500025,110.2774113511589],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.96963027802,107.5576315149113,105.1497308836454,102.7391448931055,100.3407948749692,97.96891637565059,95.63438059042126,93.34488183116507,91.10556107949256,88.91960042855841,86.78870686240452,84.71348851061819],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,115.5297561862895,117.1506003897628,118.8635019871178,120.6635578969621,122.5255805804591,124.4263160206945,126.3469706408484,128.2728906197284,130.1928213128663,132.098210008019,133.9826318376004,135.8413341916996]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="arfima-autoregressive-fractionally-integrated-moving-average" class="level3">
<h3 class="anchored" data-anchor-id="arfima-autoregressive-fractionally-integrated-moving-average"><strong><code>ARFIMA (Autoregressive Fractionally Integrated Moving Average)</code></strong></h3>
<p>Selected due to its capability to model time series with long memory properties, which is expected in variables like %Change_Index or Rate, where past values may influence future trends over extended periods.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Date' is in Date format and 'Cement' column is numeric</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> data_by_month <span class="sc">%&gt;%</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date),</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cement =</span> <span class="fu">as.numeric</span>(Cement))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the 'Cement' series for demonstration excluding the last 2 months for holdout</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>end_holdout <span class="ot">&lt;-</span> <span class="fu">max</span>(data_by_month<span class="sc">$</span>Date) <span class="sc">-</span> <span class="fu">months</span>(<span class="dv">2</span>)</span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data_by_month, Date <span class="sc">&lt;=</span> end_holdout)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the filtered series to time series</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>series <span class="ot">&lt;-</span> <span class="fu">ts</span>(training_data<span class="sc">$</span>Cement, <span class="at">start=</span><span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date)), <span class="fu">month</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date))), <span class="at">frequency=</span><span class="dv">12</span>)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ARFIMA model</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>fit_arfima <span class="ot">&lt;-</span> <span class="fu">arfima</span>(series)</span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months including 99% confidence interval</span></span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>future_arfima <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_arfima, <span class="at">h=</span><span class="dv">12</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">99</span>))  <span class="co"># Include 99% confidence interval</span></span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert forecast to an 'xts' object for plotting, includes mean and confidence intervals</span></span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>last_training_date <span class="ot">&lt;-</span> <span class="fu">max</span>(training_data<span class="sc">$</span>Date)</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>forecast_dates <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>forecast_xts_arfima <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arfima<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates)</span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_arfima <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arfima<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates)  <span class="co"># Adjusted for ARFIMA specifics</span></span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_arfima <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_arfima<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates)  <span class="co"># Adjusted for ARFIMA specifics</span></span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an xts object from actual data for plotting</span></span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>actual_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(data_by_month<span class="sc">$</span>Cement, <span class="at">order.by =</span> data_by_month<span class="sc">$</span>Date)</span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual, forecasted, and confidence interval data for plotting</span></span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>combined_xts_arfima <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_arfima, forecast_lower_xts_arfima, forecast_upper_xts_arfima, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with dygraph</span></span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_arfima, <span class="at">main =</span> <span class="st">"ARFIMA FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_arfima"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_arfima"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_arfima"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-c1cbc1095d8aecb7204d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-c1cbc1095d8aecb7204d">{"x":{"attrs":{"title":"ARFIMA FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.4311902081738,111.8846886182882,111.2583237437128,110.7608621989518,110.1026858714724,109.5201264300882,108.8641008305902,108.2583898685006,107.6261304163374,107.031983465095,106.4361294206122,105.8721330338833],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.7388637446241,107.295008645357,104.6853909509856,102.0769911758328,99.11947539077511,96.40177629450244,93.68749609959418,91.21595487218642,88.85707868237898,86.71144365669761,84.70611942496701,82.88115494472652],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,115.1235166717235,116.4743685912193,117.83125653644,119.4447332220708,121.0858963521697,122.638476565674,124.0407055615862,125.3008248648148,126.3951821502959,127.3525232734924,128.1661394162573,128.8631111230401]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="ets-error-trend-seasonality" class="level3">
<h3 class="anchored" data-anchor-id="ets-error-trend-seasonality"><strong><code>ETS (Error, Trend, Seasonality)</code></strong></h3>
<p>Utilized for its flexibility in modeling time series with or without seasonal and trend components, making it an excellent choice for variables such as Cement, SteelBar, or ReadyMixConcrete, which might exhibit cyclical industry patterns.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Ensure 'Date' is in Date format and 'Cement' column is numeric</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>data_by_month <span class="ot">&lt;-</span> data_by_month <span class="sc">%&gt;%</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Date =</span> <span class="fu">as.Date</span>(Date),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Cement =</span> <span class="fu">as.numeric</span>(Cement))</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Subsetting the 'Cement' series for demonstration excluding the last 2 months for holdout</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>end_holdout <span class="ot">&lt;-</span> <span class="fu">max</span>(data_by_month<span class="sc">$</span>Date) <span class="sc">-</span> <span class="fu">months</span>(<span class="dv">2</span>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>training_data <span class="ot">&lt;-</span> <span class="fu">filter</span>(data_by_month, Date <span class="sc">&lt;=</span> end_holdout)</span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert the filtered series to time series</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>series <span class="ot">&lt;-</span> <span class="fu">ts</span>(training_data<span class="sc">$</span>Cement, <span class="at">start=</span><span class="fu">c</span>(<span class="fu">year</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date)), <span class="fu">month</span>(<span class="fu">min</span>(training_data<span class="sc">$</span>Date))), <span class="at">frequency =</span> <span class="dv">12</span>)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ETS model</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>fit_ets <span class="ot">&lt;-</span> <span class="fu">ets</span>(series)</span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months including 99% confidence interval</span></span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>future_ets <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_ets, <span class="at">h =</span> <span class="dv">12</span>, <span class="at">level =</span> <span class="fu">c</span>(<span class="dv">99</span>))  <span class="co"># Including 99% CI</span></span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert forecast to an 'xts' object for plotting, includes mean and confidence intervals</span></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a>last_training_date <span class="ot">&lt;-</span> <span class="fu">max</span>(training_data<span class="sc">$</span>Date)</span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>forecast_dates_ets <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>forecast_xts_ets <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_ets<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_ets)</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_ets <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_ets<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_ets)  <span class="co"># 99% CI lower</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_ets <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_ets<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_ets)  <span class="co"># 99% CI upper</span></span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an xts object from actual data for plotting</span></span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a>actual_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(data_by_month<span class="sc">$</span>Cement, <span class="at">order.by =</span> data_by_month<span class="sc">$</span>Date)</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual, forecasted, and confidence interval data for plotting</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a>combined_xts_ets <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_ets, forecast_lower_xts_ets, forecast_upper_xts_ets, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot with dygraph</span></span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_ets, <span class="at">main =</span> <span class="st">"ETS FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_ets"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_ets"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_ets"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-d2a1562e3a99934010a8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d2a1562e3a99934010a8">{"x":{"attrs":{"title":"ETS FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.7033903542439,112.2981029720415,111.9407745261404,111.6257298840982,111.3479654698234,111.1030697961902,110.8871534012811,110.6967870754947,110.5289473984351,110.3809687205934,110.250500827188,110.1354716117775],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.5478229780534,106.9668244971959,104.2518270605543,101.4708291863447,98.6676781232369,95.87181820238263,93.10335036403025,90.37600177446765,87.69901022684881,85.07838551135787,82.51778651026206,80.01914826827274],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,115.8589577304344,117.6293814468872,119.6297219917265,121.7806305818517,124.0282528164098,126.3343213899977,128.6709564385319,131.0175723765217,133.3588845700214,135.6835519298289,137.983215144114,140.2517949552822]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="holt-winters-method" class="level3">
<h3 class="anchored" data-anchor-id="holt-winters-method"><strong><code>Holt-Winters Method</code></strong></h3>
<p>This method, including its Additive, Multiplicative, and Damped Trend variations, was chosen for its strength in forecasting data with seasonal variations. We apply:</p>
<ul>
<li><p><strong>Multiplicative and Multiplicative Damped Trend</strong> models for series where seasonal effects multiply as the series grows, applicable to demand cycles in construction materials.</p></li>
<li><p><strong>Additive and Additive Damped Trend</strong> models for series with constant seasonal fluctuations, relevant for our financial rates and indices with smaller, consistent seasonal changes.</p></li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit HW Multiplicative model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fit_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">HoltWinters</span>(series, <span class="at">seasonal =</span> <span class="st">"multiplicative"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months including 99% confidence interval</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>future_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_hw_multiplicative, <span class="at">h=</span><span class="dv">12</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>last_training_date <span class="ot">&lt;-</span> <span class="fu">max</span>(training_data<span class="sc">$</span>Date)</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>forecast_dates_hw <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>forecast_xts_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_hw)</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and convert the lower and upper bounds of the 99% CI for plotting</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw) <span class="co"># Index based on typical structure, adjust if needed</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw) <span class="co"># Same here</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual data and forecast for plotting</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>actual_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(data_by_month<span class="sc">$</span>Cement, <span class="at">order.by =</span> data_by_month<span class="sc">$</span>Date)</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>combined_xts_hw_multiplicative <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_hw_multiplicative, forecast_lower_xts_hw_multiplicative, forecast_upper_xts_hw_multiplicative, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with dygraph</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_hw_multiplicative, <span class="at">main =</span> <span class="st">"HW MULTIPLICATIVE FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_hw_multiplicative"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_hw_multiplicative"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_hw_multiplicative"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-9f6913c45b8ba1140e4a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9f6913c45b8ba1140e4a">{"x":{"attrs":{"title":"HW MULTIPLICATIVE FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.1472907053494,111.0154407255235,111.5600385923148,111.6042454265231,111.5929206178641,110.9657602985283,110.3404697517705,109.4371834719252,108.8674087005189,107.8371931049349,107.2792282483599,106.7314590686092],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,108.904405525092,105.5705421009129,103.6580445415128,101.0428048707069,98.15137145357221,94.51323112103643,90.69719081759226,86.48960744717553,82.39013876338086,77.79794099913804,73.40969496586411,68.54671017321027],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,115.3901758856068,116.460339350134,119.4620326431168,122.1656859823392,125.0344697821559,127.4182894760201,129.9837486859488,132.3847594966748,135.344678637657,137.8764452107318,141.1487615308557,144.9162079640081]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit HW Multiplicative Damped Trend model with specified level</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fit_hw_multiplicative_damped <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">hw</span>(series, <span class="at">seasonal =</span> <span class="st">"multiplicative"</span>, <span class="at">damped =</span> <span class="cn">TRUE</span>, <span class="at">level =</span> <span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>future_hw_multiplicative_damped <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_hw_multiplicative_damped, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>forecast_dates_hw_damped <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>forecast_xts_hw_multiplicative_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative_damped<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_hw_damped)</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and convert the lower and upper bounds of the 99% CI for plotting</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_hw_multiplicative_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative_damped<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_damped)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_hw_multiplicative_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_multiplicative_damped<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_damped)</span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual data and forecast for plotting</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>combined_xts_hw_multiplicative_damped <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_hw_multiplicative_damped, forecast_lower_xts_hw_multiplicative_damped, forecast_upper_xts_hw_multiplicative_damped, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with dygraph</span></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_hw_multiplicative_damped, <span class="at">main =</span> <span class="st">"HW MULTIPLICATIVE DAMPED TREND FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_hw_multiplicative_damped"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_hw_multiplicative_damped"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_hw_multiplicative_damped"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-b65034cf06d2718e3eb8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b65034cf06d2718e3eb8">{"x":{"attrs":{"title":"HW MULTIPLICATIVE DAMPED TREND FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,113.3178961639641,113.0925403917795,113.7801294180084,112.5515210244148,112.3474562151307,112.3998402118236,112.5729563889536,111.4499082999064,110.9976892201851,110.2909188819976,109.867703382677,110.3807576074258],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.0915103871516,107.2415057363151,106.3137985965666,103.6259144497923,101.9115995437626,100.4394952979678,99.07992624386281,96.60135728758998,94.73608374743071,92.6814377060134,90.89403504991509,89.89563030372696],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,117.5442819407766,118.9435750472439,121.2464602394502,121.4771275990372,122.7833128864989,124.3601851256794,126.0659865340444,126.2984593122229,127.2592946929395,127.9004000579818,128.841371715439,130.8658849111247]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit HW Additive model with specified level</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fit_hw_additive <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">hw</span>(series, <span class="at">seasonal =</span> <span class="st">"additive"</span>, <span class="at">level =</span> <span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>future_hw_additive <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_hw_additive, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>forecast_dates_hw_additive <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>forecast_xts_hw_additive <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_hw_additive)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and convert the lower and upper bounds of the 99% CI for plotting</span></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_hw_additive <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_additive)</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_hw_additive <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_additive)</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual data and forecast for plotting</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>combined_xts_hw_additive <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_hw_additive, forecast_lower_xts_hw_additive, forecast_upper_xts_hw_additive, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with dygraph</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_hw_additive, <span class="at">main =</span> <span class="st">"HW ADDITIVE FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_hw_additive"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_hw_additive"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_hw_additive"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-ada6708ce973dcfcb08e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-ada6708ce973dcfcb08e">{"x":{"attrs":{"title":"HW ADDITIVE FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,113.0370845081719,112.7032015539277,112.6894648677892,111.9752871302979,111.5869233887668,111.416858111042,111.3025790719161,111.1956240616769,110.7782215923227,110.4525148610103,110.2078762842655,110.0727330326083],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.4852641974286,107.3333981406672,105.6813468421546,103.3784765571208,101.405468393263,99.63393506694268,97.89050105383909,96.12065654782374,94.00316160363114,91.93817585516918,89.91398767316981,87.95850521764596],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,116.5889048189151,118.0730049671882,119.6975828934237,120.5720977034751,121.7683783842706,123.1997811551412,124.714657089993,126.27059157553,127.5532815810143,128.9668538668514,130.5017648953612,132.1869608475706]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit HW Additive Damped Trend model with specified level</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>fit_hw_additive_damped <span class="ot">&lt;-</span> forecast<span class="sc">::</span><span class="fu">hw</span>(series, <span class="at">seasonal =</span> <span class="st">"additive"</span>, <span class="at">damped =</span> <span class="cn">TRUE</span>, <span class="at">level =</span> <span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>future_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_hw_additive_damped, <span class="at">h =</span> <span class="dv">12</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>forecast_dates_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>forecast_xts_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive_damped<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_hw_additive_damped)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and convert the lower and upper bounds of the 99% CI for plotting</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive_damped<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_additive_damped)</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_hw_additive_damped<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_hw_additive_damped)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual data and forecast for plotting</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>combined_xts_hw_additive_damped <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_hw_additive_damped, forecast_lower_xts_hw_additive_damped, forecast_upper_xts_hw_additive_damped, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with dygraph</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_hw_additive_damped, <span class="at">main =</span> <span class="st">"HW ADDITIVE DAMPED TREND FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_hw_additive_damped"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_hw_additive_damped"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_hw_additive_damped"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-5e8e0aa10ce753710717" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5e8e0aa10ce753710717">{"x":{"attrs":{"title":"HW ADDITIVE DAMPED TREND FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.6698237930108,111.7932990580495,111.4134845953032,110.9738057861979,110.8030375658668,110.7659647345235,110.9453815262448,110.6361583330153,110.7444405739398,110.8190591600908,110.5681019070808,110.7033302229985],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.2641760679201,106.6826041077978,104.8139119886772,102.9837251583239,101.4820472059236,100.157087441569,99.08354403446504,97.55196343686522,96.46599536536928,95.37290465458086,93.97969606571741,92.99729862182241],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,116.0754715181014,116.9039940083012,118.0130572019292,118.963886414072,120.1240279258101,121.3748420274781,122.8072190180246,123.7203532291655,125.0228857825104,126.2652136656008,127.1565077484443,128.4093618241745]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="tbats" class="level3">
<h3 class="anchored" data-anchor-id="tbats"><strong><code>TBATS</code></strong></h3>
<p><strong>(Trigonometric, Box-Cox transformation, ARMA errors, Trend, and Seasonal components)</strong></p>
<p>Adopted for its ability to handle time series with complex or multiple seasonal patterns, which is crucial for our dataset that includes construction materials and financial variables potentially subject to multiple influencing cycles.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit TBATS model</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>fit_tbats <span class="ot">&lt;-</span> <span class="fu">tbats</span>(series)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Forecast for the next 12 months including 99% confidence interval</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>future_tbats <span class="ot">&lt;-</span> <span class="fu">forecast</span>(fit_tbats, <span class="at">h=</span><span class="dv">12</span>, <span class="at">level=</span><span class="fu">c</span>(<span class="dv">99</span>))</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Prepare for plotting</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>last_training_date <span class="ot">&lt;-</span> <span class="fu">max</span>(training_data<span class="sc">$</span>Date)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>forecast_dates_tbats <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> last_training_date <span class="sc">+</span> <span class="fu">months</span>(<span class="dv">1</span>), <span class="at">by =</span> <span class="st">"month"</span>, <span class="at">length.out =</span> <span class="dv">12</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>forecast_xts_tbats <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_tbats<span class="sc">$</span>mean, <span class="at">order.by =</span> forecast_dates_tbats)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract and convert the lower and upper bounds of the 99% CI for plotting</span></span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>forecast_lower_xts_tbats <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_tbats<span class="sc">$</span>lower[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_tbats)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>forecast_upper_xts_tbats <span class="ot">&lt;-</span> <span class="fu">xts</span>(future_tbats<span class="sc">$</span>upper[, <span class="st">"99%"</span>], <span class="at">order.by =</span> forecast_dates_tbats)</span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Combine actual data and forecast for plotting</span></span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>actual_xts <span class="ot">&lt;-</span> <span class="fu">xts</span>(data_by_month<span class="sc">$</span>Cement, <span class="at">order.by =</span> data_by_month<span class="sc">$</span>Date)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>combined_xts_tbats <span class="ot">&lt;-</span> <span class="fu">merge</span>(actual_xts, forecast_xts_tbats, forecast_lower_xts_tbats, forecast_upper_xts_tbats, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting with dygraph</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a><span class="fu">dygraph</span>(combined_xts_tbats, <span class="at">main =</span> <span class="st">"TBATS FORECAST OF: Cement for 12 Months"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyOptions</span>(<span class="at">drawGrid =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_xts_tbats"</span>, <span class="at">label =</span> <span class="st">"Forecast"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_lower_xts_tbats"</span>, <span class="at">label =</span> <span class="st">"Lower CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dySeries</span>(<span class="st">"forecast_upper_xts_tbats"</span>, <span class="at">label =</span> <span class="st">"Upper CI"</span>) <span class="sc">%&gt;%</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">dyLegend</span>(<span class="at">width =</span> <span class="dv">400</span>, <span class="at">show =</span> <span class="st">"always"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="dygraphs html-widget html-fill-item" id="htmlwidget-a626e99e125ca62656a5" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a626e99e125ca62656a5">{"x":{"attrs":{"title":"TBATS FORECAST OF: Cement for 12 Months","labels":["month","actual_xts","Forecast","Lower CI","Upper CI"],"retainDateWindow":false,"axes":{"x":{"pixelsPerLabel":60,"drawAxis":true},"y":{"drawAxis":true}},"stackedGraph":false,"fillGraph":false,"fillAlpha":0.15,"stepPlot":false,"drawPoints":false,"pointSize":1,"drawGapEdgePoints":false,"connectSeparatedPoints":false,"strokeWidth":1,"strokeBorderColor":"white","colorValue":0.5,"colorSaturation":1,"includeZero":false,"drawAxesAtZero":false,"logscale":false,"axisTickSize":3,"axisLineColor":"black","axisLineWidth":0.3,"axisLabelColor":"black","axisLabelFontSize":14,"axisLabelWidth":60,"drawGrid":false,"gridLineWidth":0.3,"rightGap":5,"digitsAfterDecimal":2,"labelsKMB":false,"labelsKMG2":false,"labelsUTC":false,"maxNumberWidth":6,"animatedZooms":false,"mobileDisableYTouch":true,"disableZoom":false,"series":{"Forecast":{"axis":"y"},"Lower CI":{"axis":"y"},"Upper CI":{"axis":"y"}},"legend":"always","labelsDivWidth":400,"labelsShowZeroValues":true,"labelsSeparateLines":false,"hideOverlayOnMouseOut":true},"scale":"monthly","annotations":[],"shadings":[],"events":[],"format":"date","data":[["2005-07-01T00:00:00.000Z","2005-08-01T00:00:00.000Z","2005-09-01T00:00:00.000Z","2005-10-01T00:00:00.000Z","2005-11-01T00:00:00.000Z","2005-12-01T00:00:00.000Z","2006-01-01T00:00:00.000Z","2006-02-01T00:00:00.000Z","2006-03-01T00:00:00.000Z","2006-04-01T00:00:00.000Z","2006-05-01T00:00:00.000Z","2006-06-01T00:00:00.000Z","2006-07-01T00:00:00.000Z","2006-08-01T00:00:00.000Z","2006-09-01T00:00:00.000Z","2006-10-01T00:00:00.000Z","2006-11-01T00:00:00.000Z","2006-12-01T00:00:00.000Z","2007-01-01T00:00:00.000Z","2007-02-01T00:00:00.000Z","2007-03-01T00:00:00.000Z","2007-04-01T00:00:00.000Z","2007-05-01T00:00:00.000Z","2007-06-01T00:00:00.000Z","2007-07-01T00:00:00.000Z","2007-08-01T00:00:00.000Z","2007-09-01T00:00:00.000Z","2007-10-01T00:00:00.000Z","2007-11-01T00:00:00.000Z","2007-12-01T00:00:00.000Z","2008-01-01T00:00:00.000Z","2008-02-01T00:00:00.000Z","2008-03-01T00:00:00.000Z","2008-04-01T00:00:00.000Z","2008-05-01T00:00:00.000Z","2008-06-01T00:00:00.000Z","2008-07-01T00:00:00.000Z","2008-08-01T00:00:00.000Z","2008-09-01T00:00:00.000Z","2008-10-01T00:00:00.000Z","2008-11-01T00:00:00.000Z","2008-12-01T00:00:00.000Z","2009-01-01T00:00:00.000Z","2009-02-01T00:00:00.000Z","2009-03-01T00:00:00.000Z","2009-04-01T00:00:00.000Z","2009-05-01T00:00:00.000Z","2009-06-01T00:00:00.000Z","2009-07-01T00:00:00.000Z","2009-08-01T00:00:00.000Z","2009-09-01T00:00:00.000Z","2009-10-01T00:00:00.000Z","2009-11-01T00:00:00.000Z","2009-12-01T00:00:00.000Z","2010-01-01T00:00:00.000Z","2010-02-01T00:00:00.000Z","2010-03-01T00:00:00.000Z","2010-04-01T00:00:00.000Z","2010-05-01T00:00:00.000Z","2010-06-01T00:00:00.000Z","2010-07-01T00:00:00.000Z","2010-08-01T00:00:00.000Z","2010-09-01T00:00:00.000Z","2010-10-01T00:00:00.000Z","2010-11-01T00:00:00.000Z","2010-12-01T00:00:00.000Z","2011-01-01T00:00:00.000Z","2011-02-01T00:00:00.000Z","2011-03-01T00:00:00.000Z","2011-04-01T00:00:00.000Z","2011-05-01T00:00:00.000Z","2011-06-01T00:00:00.000Z","2011-07-01T00:00:00.000Z","2011-08-01T00:00:00.000Z","2011-09-01T00:00:00.000Z","2011-10-01T00:00:00.000Z","2011-11-01T00:00:00.000Z","2011-12-01T00:00:00.000Z","2012-01-01T00:00:00.000Z","2012-02-01T00:00:00.000Z","2012-03-01T00:00:00.000Z","2012-04-01T00:00:00.000Z","2012-05-01T00:00:00.000Z","2012-06-01T00:00:00.000Z","2012-07-01T00:00:00.000Z","2012-08-01T00:00:00.000Z","2012-09-01T00:00:00.000Z","2012-10-01T00:00:00.000Z","2012-11-01T00:00:00.000Z","2012-12-01T00:00:00.000Z","2013-01-01T00:00:00.000Z","2013-02-01T00:00:00.000Z","2013-03-01T00:00:00.000Z","2013-04-01T00:00:00.000Z","2013-05-01T00:00:00.000Z","2013-06-01T00:00:00.000Z","2013-07-01T00:00:00.000Z","2013-08-01T00:00:00.000Z","2013-09-01T00:00:00.000Z","2013-10-01T00:00:00.000Z","2013-11-01T00:00:00.000Z","2013-12-01T00:00:00.000Z","2014-01-01T00:00:00.000Z","2014-02-01T00:00:00.000Z","2014-03-01T00:00:00.000Z","2014-04-01T00:00:00.000Z","2014-05-01T00:00:00.000Z","2014-06-01T00:00:00.000Z","2014-07-01T00:00:00.000Z","2014-08-01T00:00:00.000Z","2014-09-01T00:00:00.000Z","2014-10-01T00:00:00.000Z","2014-11-01T00:00:00.000Z","2014-12-01T00:00:00.000Z","2015-01-01T00:00:00.000Z","2015-02-01T00:00:00.000Z","2015-03-01T00:00:00.000Z","2015-04-01T00:00:00.000Z","2015-05-01T00:00:00.000Z","2015-06-01T00:00:00.000Z","2015-07-01T00:00:00.000Z","2015-08-01T00:00:00.000Z","2015-09-01T00:00:00.000Z","2015-10-01T00:00:00.000Z","2015-11-01T00:00:00.000Z","2015-12-01T00:00:00.000Z","2016-01-01T00:00:00.000Z","2016-02-01T00:00:00.000Z","2016-03-01T00:00:00.000Z","2016-04-01T00:00:00.000Z","2016-05-01T00:00:00.000Z","2016-06-01T00:00:00.000Z","2016-07-01T00:00:00.000Z","2016-08-01T00:00:00.000Z","2016-09-01T00:00:00.000Z","2016-10-01T00:00:00.000Z","2016-11-01T00:00:00.000Z","2016-12-01T00:00:00.000Z","2017-01-01T00:00:00.000Z","2017-02-01T00:00:00.000Z","2017-03-01T00:00:00.000Z","2017-04-01T00:00:00.000Z","2017-05-01T00:00:00.000Z","2017-06-01T00:00:00.000Z","2017-07-01T00:00:00.000Z","2017-08-01T00:00:00.000Z","2017-09-01T00:00:00.000Z","2017-10-01T00:00:00.000Z","2017-11-01T00:00:00.000Z","2017-12-01T00:00:00.000Z","2018-01-01T00:00:00.000Z","2018-02-01T00:00:00.000Z","2018-03-01T00:00:00.000Z","2018-04-01T00:00:00.000Z","2018-05-01T00:00:00.000Z","2018-06-01T00:00:00.000Z","2018-07-01T00:00:00.000Z","2018-08-01T00:00:00.000Z","2018-09-01T00:00:00.000Z","2018-10-01T00:00:00.000Z","2018-11-01T00:00:00.000Z","2018-12-01T00:00:00.000Z","2019-01-01T00:00:00.000Z","2019-02-01T00:00:00.000Z","2019-03-01T00:00:00.000Z","2019-04-01T00:00:00.000Z","2019-05-01T00:00:00.000Z","2019-06-01T00:00:00.000Z","2019-07-01T00:00:00.000Z","2019-08-01T00:00:00.000Z","2019-09-01T00:00:00.000Z","2019-10-01T00:00:00.000Z","2019-11-01T00:00:00.000Z","2019-12-01T00:00:00.000Z","2020-01-01T00:00:00.000Z","2020-02-01T00:00:00.000Z","2020-03-01T00:00:00.000Z","2020-04-01T00:00:00.000Z","2020-05-01T00:00:00.000Z","2020-06-01T00:00:00.000Z","2020-07-01T00:00:00.000Z","2020-08-01T00:00:00.000Z","2020-09-01T00:00:00.000Z","2020-10-01T00:00:00.000Z","2020-11-01T00:00:00.000Z","2020-12-01T00:00:00.000Z","2021-01-01T00:00:00.000Z","2021-02-01T00:00:00.000Z","2021-03-01T00:00:00.000Z","2021-04-01T00:00:00.000Z","2021-05-01T00:00:00.000Z","2021-06-01T00:00:00.000Z","2021-07-01T00:00:00.000Z","2021-08-01T00:00:00.000Z","2021-09-01T00:00:00.000Z","2021-10-01T00:00:00.000Z","2021-11-01T00:00:00.000Z","2021-12-01T00:00:00.000Z","2022-01-01T00:00:00.000Z","2022-02-01T00:00:00.000Z","2022-03-01T00:00:00.000Z","2022-04-01T00:00:00.000Z","2022-05-01T00:00:00.000Z","2022-06-01T00:00:00.000Z","2022-07-01T00:00:00.000Z","2022-08-01T00:00:00.000Z","2022-09-01T00:00:00.000Z","2022-10-01T00:00:00.000Z","2022-11-01T00:00:00.000Z","2022-12-01T00:00:00.000Z","2023-01-01T00:00:00.000Z","2023-02-01T00:00:00.000Z","2023-03-01T00:00:00.000Z","2023-04-01T00:00:00.000Z","2023-05-01T00:00:00.000Z","2023-06-01T00:00:00.000Z","2023-07-01T00:00:00.000Z","2023-08-01T00:00:00.000Z","2023-09-01T00:00:00.000Z","2023-10-01T00:00:00.000Z","2023-11-01T00:00:00.000Z","2023-12-01T00:00:00.000Z","2024-01-01T00:00:00.000Z","2024-02-01T00:00:00.000Z","2024-03-01T00:00:00.000Z","2024-04-01T00:00:00.000Z","2024-05-01T00:00:00.000Z","2024-06-01T00:00:00.000Z","2024-07-01T00:00:00.000Z","2024-08-01T00:00:00.000Z","2024-09-01T00:00:00.000Z","2024-10-01T00:00:00.000Z"],[85.33,85.78,86.11,86.11,86.11,86.11,87.22,87.44,87.67,87.67,88,88,88,88,88.56,88.56,88.56,88.56,89.86,89.86,91.14,92.29000000000001,92.43000000000001,95.38,102.5,107.4,109.3,111,114.9,115.4,116.7,118.9,119.7,120,120.1,123.7,125.43,126,126.3,125.6,123.4,120.4,117.5,111.9,109.4,106.4,105.2,103.3,101.2,99.40000000000001,99.3,96.59999999999999,95.09999999999999,93.40000000000001,90.40000000000001,90,89.8,89.09999999999999,89.09999999999999,89,88.8,88.90000000000001,88.59999999999999,88.59999999999999,88.40000000000001,89,90.3,91.40000000000001,92.59999999999999,93.5,93.7,93.59999999999999,94,94.2,94.3,95.5,96.09999999999999,96.2,98.3,99.09999999999999,99.2,101.5,101.1,100.9,101.7,101.5,101.4,101.7,101.9,102.1,101.2,101.7,100.8,101,100.5,100,99.8,99.8,99.59999999999999,99.7,99.3,99.3,99.3,99,98.5,98.7,98.7,98.59999999999999,98.09999999999999,97.90000000000001,97.2,97,96.40000000000001,95.7,95.09999999999999,94.40000000000001,94.3,93.8,93.59999999999999,93,92.59999999999999,92.59999999999999,92.40000000000001,92,91,90.8,88.90000000000001,87.3,86.7,84.5,84.2,82.59999999999999,81.2,81.09999999999999,80.5,80.09999999999999,79.3,79,76.8,76.3,75.90000000000001,76.5,76.2,76.5,76,74.8,75.3,75.8,75.40000000000001,75.40000000000001,76.09999999999999,75.7,76.90000000000001,77.09999999999999,77.59999999999999,77.8,78.90000000000001,79,79.09999999999999,79.3,79.7,79.8,80.8,81.3,81.3,81.3,82.2,82.5,83,83,83,84.3,84.8,84.59999999999999,85.2,85.3,86,86.09999999999999,86.09999999999999,86.09999999999999,86.09999999999999,85.90000000000001,85.7,86,86,85.7,85.7,85.7,85.8,88.40000000000001,90,91.2,95,95.09999999999999,95.09999999999999,95.40000000000001,96.09999999999999,97.5,104.6,106.3,110,112.7,118.4,118.3,118.5,119,118.6,118.6,118.4,118.3,118.5,118.4,118.2,118,117.2,116.7,115.2,114.4,113.5,113.2,112,111.8,null,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,112.7196886587908,112.30620457899,111.94405791693,111.625528578441,111.3450215494513,111.0978727850402,110.8800455345261,110.688012335681,110.51868188193,110.369341659916,110.2376095501029,110.1213921746741],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,109.4893046177021,106.9913005089271,104.5473219047438,102.1419798307181,99.79215058344788,97.51233629207641,95.31185835148526,93.19580127376788,91.16618104135652,89.22287298638891,87.36429431333822,85.58789652802682],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,116.0453423926265,117.8850193527333,119.8638861386211,121.9892027512349,124.2347544644395,126.5752869531131,128.9899312851361,131.4618093763266,133.9772583636577,136.5251654000162,139.0964514403076,141.683675695997]],"fixedtz":false,"tzone":"UTC"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="data-visualization-design" class="level1">
<h1>3. Data Visualization Design</h1>
<p><img src="Image/Image1.png" class="img-fluid"></p>
<p>Figure 1: Proposed Layout For Time Series Forecasting</p>
<p><img src="Image/Image2.png" class="img-fluid"></p>
<p>Figure 2: Proposed Layout For Time Series Forecasting With Explanations</p>
<p>We designed the user interface (UI) of our time series forecasting application with multiple components to enhance interactivity and user engagement. Here’s how we approached the design:</p>
<ol type="1">
<li><p><strong>Top Navigation Tabs</strong>: We implemented tabs at the top (Dashboard, Data Exploration, Time Series Forecasting, ML) to facilitate easy navigation throughout the application. This design choice aims to provide clear and accessible navigation paths, allowing users to seamlessly switch between different analytical contexts without confusion.</p></li>
<li><p><strong>Series Selection Dropdown</strong>: We incorporated a dropdown menu for users to select from different time series variables such as Cement, SteelBar, Granite, etc. This feature supports user autonomy by enabling them to choose the specific series they wish to analyze, adhering to the principles of user control and freedom.</p></li>
<li><p><strong>Forecasting Model Selection Tabs</strong>: We added model selection tabs (ARIMA, ARFIMA, ETS, TBATS, HW MULTIPLE) to allow users to easily switch between various forecasting models. This component is designed to support comparative analysis and cater to different user preferences and data specifics, promoting an inclusive user experience.</p></li>
<li><p><strong>Configurable Settings</strong>:</p>
<ul>
<li><p>We provided options for users to define historical data ranges, forecast periods, confidence intervals, and hold-out periods. This customization capability is intended to enhance flexibility and efficiency, allowing users to tailor the analysis to their specific needs.</p></li>
<li><p>We included sliders for forecast and hold-out period adjustments to offer a dynamic interaction mechanism. This choice enhances the application’s intuitiveness and user engagement by allowing for easy and immediate parameter modifications.</p></li>
</ul></li>
<li><p><strong>Interactive Forecast Visualization</strong>:</p>
<ul>
<li><p>Our design features an interactive forecast chart that updates in real time based on the user’s selections, such as the forecasting model and time range. We ensured the chart’s title reflects these selections (e.g., “ARIMA FORECAST OF: Cement for 12 Months”) to provide clear and immediate feedback.</p></li>
<li><p>We integrated a slider beneath the forecast chart to enable refined time period exploration. This element allows users to visually adjust and examine different segments of the forecast, promoting a hands-on analytical experience.</p></li>
</ul></li>
<li><p><strong>Consistency and Clarity in Visual Design</strong>:</p>
<ul>
<li><p>We focused on clear labeling, consistent visual themes, and distinct section demarcations to ensure the interface is straightforward and user-friendly. The use of contrasting colors and structured layouts aids in distinguishing between various UI elements and functionalities.</p></li>
<li><p>Our design prioritizes real-time feedback, such as dynamically updating charts and titles based on user interactions. This approach is aimed at keeping users engaged and informed about the consequences of their actions within the application.</p></li>
</ul></li>
</ol>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>